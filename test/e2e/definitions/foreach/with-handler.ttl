@base <http://example.org/pipeline/>.
@prefix code: <https://code.described.at/>.
@prefix p: <https://pipeline.described.at/>.
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>.
@prefix base: <https://barnard59.zazuko.com/operations/base/> .
@prefix fs: <https://barnard59.zazuko.com/operations/core/fs/> .

<> a p:Pipeline, p:Readable;
  p:steps [
    p:stepList
    (
      <iterateDirectory>
      [ base:forEach ( <Print> "file" ) ]
    )
  ] .

<iterateDirectory> a p:Step;
  code:implementedBy [ a code:EcmaScriptModule;
    code:link <file:operations/iterateDirectory.js#default>
  ];
  code:arguments ("definitions/foreach").

<Print> a p:Pipeline, p:ReadableObjectMode;
  p:steps [
    p:stepList
    (
      [ fs:createReadStream("file"^^p:VariableName) ]
      <getLength>
    )
  ].

<getLength> a p:Step;
  code:implementedBy [ a code:EcmaScriptModule;
    code:link <file:operations/inlineTransform.js#default>
  ];
  code:arguments ("_ => this.variables.get('file')"^^code:EcmaScript).
